# 年前总结
## 2025-1-20

## 进展

- 1、1月10号去过公司找胡师兄，了解项目的现况，得到一些关于硬件、调试器、型号的要求。
- 2、结合师兄所给的ST MCSDKV5.4和已整理的资料，查找到一些相关的链接，给出了库的架构图，也有介绍相关的API,为读懂整个库奠定了基础。
> [st工程师讲解库]（https://c.51diantang.com/columndetail?id=126b8417f88949799f4caf99e98e2ee1）
> [野火] （https://doc.embedfire.com/motor/motor_tutorial/zh/latest/index.html）
> [正点] （https://zhuanlan.zhihu.com/p/654667951）
- 3、基本的FOC控制流程，电流环（力矩环）、速度环、位置环，克拉克变换、帕克变换、反帕克变换都已经理解了，现阶段可以尝试先看看已有的matlab模型跑跑仿真。接下来可以了解一下不同观测器的原理，主要看滑膜观测器smo的原理。
- 4、目前已经回到家中，不在杭州，正在阅读STMCSDKV5.4.4的源码，年前这段时间可以完全理解这个库，熟悉ST给出的电机控制思路与软件流程。当时拿到源码后，看的一头雾水，电机启动的函数MCBOOT方式很特别，也很庞大，包括了各种各样的结构体，和一些定义的数组初始化，模块宏等等，所以本来想着能马上动手实操的计划也不能够顺利进行了，具体的操作完全可以建立在掌握代码后，再实践。
- 5、有关MCSDK的信息。ST工程师讲解的视频，在AI电堂科技上可以搜索到，虽然也只是围绕ST的生态来讲电机库的发展历程，但是得到了非常有用的信息，涉及了能否设计一个面向多平台的库的大方向，根据我在ipad上记录的一些笔记如下：
---
### MC SDK 历史版本
| SDK Name | Version | Source   | 架构     |
| -------- | ------- | -------- | ------- |
| MC SDK   | V5.x    | 网络     | 结合ST生态，自动生成代码，一个面向过程的库，绑定了软件层|
| FOC Libray | V2.0 | stm32-foc-firwmare-libraries-v2.0| 经典架构，有很多客户还在使用 |
| FOC SDK | V3.0~V4.3 |stm32f10x_foc4.0|是一个面向对象的库，此时ST的生态还没有那么成熟，也就是说平台依赖性不强|

 目前我还没有理解FOC sdk这个过去版本库的架构，和面向对象的具体设计形式，但是就目前我了解到的MC SDKV5.4.4版本来说,软件层是需要使用ST CubeMX配置外设，勾选MCSDK使用，结合MC Workbench，生成了一份基于芯片外设库(ST的HAL&&LL库+CMSIS)的代码。拿到的V5.x库的源码，应该不外乎都是这样的。那这样子，和毕业设计最终要实现的多平台目标就不相符合了，所以我认为了解完MC SDKV5的库后，有必要了解FOC SDK的设计思路，而ST的工程师在介绍时说由于FOC SDK是一个面向对象的库，很多工程师在**面向过程**往**面向对象**的切换中遇到了问题，这导致了最终MCSDK还是回归了面向过程，也就是绑定了ST的Cube生态。
 
 - 6、最后就是，有一个b站的编程大佬，他有讲解如何写一份屏幕驱动的库，可以在任何型号的单片机，任何驱动方式（iic/spi），任何屏幕上使用。当然要添加的就是关于特定屏幕的选用方式和选定芯片引脚的设置，我认为将这个编程思想添加到后序成功替换MCSDK的基础上，就可以实现多平台的最终目标。

